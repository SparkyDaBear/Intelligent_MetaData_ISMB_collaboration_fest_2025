ABSTRACT:
Based on conventional data-dependent acquisition strategy of shotgun proteomics, we present a new workflow DeMix, which significantly increases the efficiency of peptide identification for in-depth shotgun analysis of complex proteomes. Capitalizing on the high resolution and mass accuracy of Orbitrap-based tandem mass spectrometry, we developed a simple deconvolution method of “cloning” chimeric tandem spectra for cofragmented peptides. Additional to a database search, a simple rescoring scheme utilizes mass accuracy and converts the unwanted cofragmenting events into a surprising advantage of multiplexing. With the combination of cloning and rescoring, we obtained on average nine peptide-spectrum matches per second on a Q-Exactive workbench, whereas the actual MS/MS acquisition rate was close to seven spectra per second. This efficiency boost to 1.24 identified peptides per MS/MS spectrum enabled analysis of over 5000 human proteins in single-dimensional LC-MS/MS shotgun experiments with an only two-hour gradient. These findings suggest a change in the dominant “one MS/MS spectrum - one peptide” paradigm for data acquisition and analysis in shotgun data-dependent proteomics. DeMix also demonstrated higher robustness than conventional approaches in terms of lower variation among the results of consecutive LC-MS/MS runs.
METHODS:
EXPERIMENTAL PROCEDURES
Sample Preparation
HeLa cell line was grown with Dulbecco's modified Eagle's medium supplemented with 10% fetal bovine serum and 1% antibiotics. Cells were collected and washed with PBS three times. Three separate cell pellets were lysed with ProteaseMAX™ Surfactant (0.1% w/v) in aqueous ammonium bicarbonate (50 mm) mixed with acetonitrile at a ratio of 9:1 (v:v) as previously described. Mixtures were incubated at 95 °C for 5 min and 15 min sonication (30% amplitude, 3:3 pulse) with a Branson sonicator. After that, protein extracts were reduced and alkylated via incubation with 10 mm of DTT and iodoacetamide, respectively. Proteins (80 μg) were digested with trypsin and incubated at 37 °C for 9 h. Trypsination was terminated by adding 5% acetic acid (vol.). Samples were incubated for 30 min at 45 °C in order to precipitate the detergent, and purified using spin filtration (Pall Nanosep® 10 kDa with Omega membrane).
LC-MS/MS Experiment
Three micrograms of each sample was injected to Thermo Scientific EASY-Spray columns (PepMap® RSLC, C18, 100 Å, 2 μm bead packed 50 cm column) connected to an Easy-nLC 1000 pump (Proxeon Biosystems, Odense, Denmark, now part of Thermo Fisher Scientific). Samples were loaded into the column with buffer A (99.9% water, 0.1% formic acid) and eluted in a 150 min LC-MS/MS experiment. The gradient was started from 2% and increased stepwise to 5% in 12 min, 19% in 88 min, and 30% buffer B (99.9% acetonitrile, 0.1% formic acid) in 15 min at a flow rate of 250 nL/min. It followed by a sharp increase to 98% buffer B in 15 min, then 8 min in 98% buffer B, followed by a sharp decrease to 2% buffer B in 2 min, and finally 10 min in 2% buffer B.
Data Acquisition
Mass spectra were acquired with an Orbitrap Q Exactive mass spectrometer (Thermo Scientific) in a data-dependent manner using a top-20 method. MS spectra were acquired at a resolution of 70,000 with maximum integration time of 250 ms and a target value of 3 × 106 ions. The m/z range was from 400 to 1200. Peptide fragmentation was performed via higher-energy collisional dissociation set at 25 V of normalized collisional energy. The MS/MS spectra were acquired at a resolution of 17,500, with a target value of 2 × 105 ions and a maximum integration time of 120 ms. For testing precursor selectivity, replicated experiments were performed with four different isolation widths: ±1.0, ±2.0, ±3.0, and ±4.0 Th as described in the main text. MS and MS/MS spectra in the profile mode were converted from Thermo .RAW files into mzML format using msconvert in ProteoWizard software package (v. 3.0.5047 downloaded from http://proteowizard.sourceforge.net), with zero intensity sampling being ignored (filter: zeroSamples removeExtra 1–2). The OpenMS Proteomics Pipeline (TOPP) (v. 1.11, downloaded from (http://open-ms.sourceforge.net) was used for calculating centroids of peaks from profile mass spectra, with signal-to-noise filter disabled in the PeakPickerHiRes. It was found important to use PeakPickerHiRes rather than the “Peak Picking” function in msconvert, because the former algorithm is more accurate.
The mass spectrometry proteomics data have been deposited to the ProteomeXchange Consortium (http://proteomecentral.proteomexchange.org) via the PRIDE partner repository with the dataset identifier PXD000999.
Chromatographic Feature Detection
The FeatureFinderCentroided tool in TOPP was used for detecting and quantifying peptide chromatographic features from the centroided MS spectra, with the following parameters: m/z_tolerance = 0.01 Da, charge_low = 2, charge_high = 7, and feature_min_score = 0.5. The resultant features were exported from the FeatureXML format to CSV tables, containing for each feature the RT range, monoisotopic m/z, charge state, isotope distribution, and integrated ion intensity.
MS/MS Spectra Processing
Centroided MS/MS spectra were processed by msconvert with a filter “MS2Deisotope true 0.005Da.” MS/MS data (m/z and z of the precursor as well as RT of the MS/MS event) were matched with the feature list. Normally, at least one feature matched the nominal precursor, including RT, z, and m/z (the latter within 10 ppm). When no feature from the list matched, the original MS/MS spectrum was retained “as is.” If the ±2.0 Th isolation window overlapped with another detected feature's m/z, and MS/MS RT - with feature's RT range, the MS/MS spectrum was cloned, with the precursor m/z and z of the cloned MS/MS entry being copied from the matched feature. The resultant MS/MS spectra were written in the MGF format by a home-written Python script utilizing pymzml, and converted to mzML format by msconvert.
Search Engine
We used Morpheus (rev. 45) that has been designed by Wenger et al. specifically for high resolution mass spectrometry. All options for spectral processing were unchecked. Parameters were set as: Protease = trypsin (no proline rule); Maximum Missed Cleavages = 3; Fixed Modifications = (carbamidomethylation of C); Variable Modifications = [oxidation of M, acetylation of protein N terminus]. UniProt Human Complete Proteome database (v. 2012_04, 89,601 human protein entries) was used as a source of target sequences. As a decoy, reversed protein sequences were generated on-the-fly and concatenated to the target database.
The first pass of search was done on the original MS/MS spectra with a large mass tolerance (±20 ppm) for both precursor and product monoisotopic peaks. The masses of reliably identified (in terms of FDR) peptides were used as “software lock mass” for MS scale recalibration. A Python script written in house and utilizing pyteomics package was used for theoretical mass calculation. The RT-dependent calibration curve was calculated by the method of multivariate adaptive regression splines (MARS) based on the RT and precursor m/z of unique peptide identifications (FDR < 1%). Python script was written using py-earth (https://github.com/jcrudy/py-earth) for nonlinear regression in mass error recalibration. All precursor masses in the MS/MS spectra as well as feature lists were then recalculated. The second pass database search was performed on deconvoluted MS/MS data with a narrower MS tolerance (10 ppm; the tolerance for MS/MS was still 20 ppm); it generated PSMs that were then rescored.
PSM Rescoring
The scoring scheme from the original Morpheus algorithm was reformulated. In the new scheme, the PSM score S is a summation of three subscores: S1, S2, and S3, reflecting three parameters: mass errors in MS and MS/MS, and relative fragment ion intensities, respectively. Three subscores played different roles in discriminating target and decoy peptide-spectrum matches.
Firstly, for all PSMs with q-value < 5 (equivalent of <5.0% FDR), precursor mass errors (deviations from the theoretical mass) were calculated, and the resultant mass error distribution (Fig. 2A) was fitted with normal distribution, giving the standard deviation of mass errors. Using the survival function of this normal distribution, for a given precursor mass error, a p value was calculated. The absolute p value ranging from 0.0001 to 1.0 was added to the final score of the precursor as S1. It also played the role as a soft mass tolerance. PSMs with precursor p value lower than 0.0001 were rejected as too improbable.
Furthermore, for each peptide sequence in the list, theoretical MS/MS product masses were calculated for only b- and y-series singly charged ions. Other types of ions were excluded as less probable products. By matching spectra with theoretical peaks for all PSMs in one set of data, an overall fragment mass error distribution was estimated the same way as estimating precursor mass errors (Fig. 2B). Then the σ (standard deviation) of mass error in MS/MS was calculated based on the distribution. In one PSM, each matching peak deviating from its theoretical value by less than 2σ (95.4% confidence interval) added 1.0 point to the score S2, to the maximum of (2n-2), where n is the number of residues in the peptide sequence. Additional to the original algorithm, if a complementary (b-y) pair of product peaks was found, an extra score of 1.0 was added to S2 for rewarding the confirmation of the precursor mass. As in the original Morpheus algorithm, this score of counting matched products is the major part of final score, which plays the most important role of identifying peptides. The scoring scheme was reformulated for the consideration of complementary peaks and postcalculated mass tolerance. Thus, S2 ranged from 0 to 3n-3. Comparing to the original Morpheus score, S2 provides larger space for discriminating between the target and decoy hits, and has less bias against short peptides, as the latter tend to produce more complementary fragments per unit length than longer peptides.
Because counting of matched fragments produces a discrete value, it is not optimal for a later estimation of the cutoff score in a continuous space. In order to smoothen the score distribution at the edge of the trimming threshold (e.g. at 1% FDR), the original Morpheus algorithm adds to the final score an absolute value of the matched fraction of ion intensity (ranges from 0 to 1.0), assuming that a true match will explain a larger fraction of ion peaks. Although that is generally true when comparing two alternative sequence assignments, in the case of analyzing chimeric spectra, the absolute value of ion matching varies significantly depending upon whether the assigned peptide is a primary or a secondary match. To better exploit the differences in the relative abundances of target and decoy fragments for chimeric spectra, distributions of log-transformed values of the matched fraction of ion intensity for target and decoy hits were investigated (Fig. 2C). We used the normal probability density function P(x, N) to calculate the different probabilities of being a target or decoy hit for a given fraction of intensity (ln I). The relative ratio of the probability densities of the target distribution (N3+) and decoy distribution (N3−) was calculated as  Which ranged from −1.0 to 1.0. As in the original Morpheus algorithm, the sub score S3 was used here to smoothen the score distribution at the edge of an arbitrary cutoff (1% FDR).
FDR Trimming
Duplications in the PSM list were removed, with the highest-scoring PSM retained, to ensure that one feature corresponded to only one peptide, and every deconvoluted spectrum was present only once. The filtered PSM list was sorted by score S in a descending order. The distribution of S for target and decoy peptides is shown in Fig. 2D. The FDR level was calculated as in MaxQuant/Andromeda, that is, as the ratio of decoy hits (FP, reversed sequences) and target hits (TP, forward sequences): FDR = FP/TP. The peptide list was trimmed to contain less than the chosen fraction of false identifications. As in some other search engines, sorting and trimming was done hierarchically three times for three peptide subpopulations, which possess different statistical properties in terms of FDR. First-pass: “high-risk” peptides with N-terminal proline—these peptides are rare because of trypsin specificity (no cleavage of prolyl bonds); second-pass: “medium-risk” peptides with the number of basic residues (Arg, Lys, and His) equal or larger than the charge z—these peptides are more stable in collisional dissociation; and third-pass: other peptides. Factors such as peptide length and charge were not considered as risks of causing false discoveries. The final PSM list was converted to OMSSA .csv format, which was used by Protein Herder from COMPASS package (v. 1.0.4.5, downloaded from http://www.chem.wisc.edu/∼coon/software.php) to assign peptide sequences to protein groups using the principle of maximum parsimony.
Comparison with State-of-the-Art
The same set of three .RAW files was processed using Mascot MS/MS search engine (v. 2.3.02, Matrix Science), MaxQuant software (v. 1.4.1.2, downloaded from http://maxquant.org) with Andromeda search engine, and MS-GF+ (v. 9979) with Percolator (v. 2.07). Precursor mass tolerance was set as 6 ppm. Products mass tolerance was set as 20 mmu in Mascot, 20 ppm in MaxQuant. MS-GF+ does not allow user-defined mass tolerance for MS/MS, thus we chose the default setting for Q-Exactive (parameter: -inst 3). PSMs from Mascot were filtered by E<0.05 for comparing the trimming by significance to FDR trimming. PSMs from Andromeda were filtered by 1.0% FDR. MS-GF+ resultant .mzid files were converted, rescored and filtered by Percorlator to 1.0% peptide FDR.